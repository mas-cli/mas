#!/bin/bash -e
#
# script/lint
# mas
#
# Linting checks for development and CI.
#
# Reports style violations without making any modifications to the code.
#
# Please keep in sync with script/format.
#

echo "==> ğŸš¨ Linting mas"

for LINTER in git markdownlint shfmt swiftformat swiftlint; do
  if [[ ! -x "$(command -v ${LINTER})" ]]; then
    echo "error: ${LINTER} is not installed. Run 'script/bootstrap' or 'brew install ${LINTER}'."
    exit 1
  fi
done

echo "--> ğŸŒ³ Git"
git diff --check

echo
echo "--> ğŸ–Š Markdown"
markdownlint --config .markdownlint.json .github .

echo
echo "--> ğŸ•Šï¸ Swift"
for SOURCE in Package.swift Sources Tests; do
  swiftformat --lint ${SOURCE}
  swift run swift-format lint --recursive ${SOURCE}
  swiftlint lint --strict ${SOURCE}
done

echo
echo "--> ğŸ“œ Bash"
shfmt -d -i 2 -l -w contrib/ script/
